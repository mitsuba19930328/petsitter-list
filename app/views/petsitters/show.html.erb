
<div class="breadcrumbs-list">ペットシッターリスト › 全てのペットシッター一覧 › たんぽぽハウス 高田馬場店</div>
<div class="shop-header">
  <div class="info-wrap">
    <div class="shop-controller">
        ペットシッター中原　府中店
    </div>
    <div class="shop-top-info">
      <div class="shop-top-info_rate">★★★★★ 3.5</div>
      <div class="shop-top-info_reviews">● 2件</div>
      <div class="shop-top-info_bookmarks">× 3件</div>
    </div>
    <div class="shop-bottom-info">
      <span>エリア：</span>
      <%= link_to "中野", root_path %>
      <span>対応可能動物種類：</span>
      <ul class="pet-types">
        <li class="pet-type-list"></li>
        <li class="pet-type-list"></li>
      </ul>
    </div>
  </div>
  <div class="action-wrap">
    <div class="action-wrap_app">
      <div class="action-btn">
        <i class="fas fa-user-check fa-lg"></i>
        <%= link_to "行った", root_path, class:'action-name' %>
      </div>
      <div class="action-btn">
        <i class="fas fa-bookmark fa-lg"></i>
        <%= link_to "保存", root_path, class:'action-name' %>
      </div>
    </div>
  </div>
</div>
<ul class="shop-menu-bar">
  <li class="shop-menu-link selected-menu"><%= link_to "店舗トップ", petsitter_path %></li>
  <li class="shop-menu-link"><%= link_to "詳細", petsitter_details_path %></li>
  <li class="shop-menu-link"><%= link_to "口コミ", petsitter_reviews_path %></li>
  <li class="shop-menu-link"><%= link_to "地図", petsitter_map_path %></li>
</ul>
<div class="shop-content">

  <!-- 店舗トップ -->
  <div class="shop-content_top">
    <%# if current_page?(user_path) %>
      <%= image_tag @petsitter.image.url, class:'top-cover-img' unless @petsitter.image.url.nil? %>
      <div class="shop-outline">
        たんぽぽハウス 高田馬場店は高田馬場駅から徒歩3分と近く、「噂の都内最安店」として有名な古着屋です。紳士服や婦人服を始め、バッグやシューズなど、幅広い品揃えと安い価格がおすすめポイントです。
      </div>
    <%# end %>
  </div>

  <!-- 詳細 -->
  <div class="shop-content_details">
    <%# if current_page?(user_path) %>
      <div class="items-wrapper">
        <div class="item-area">
          <div class="item-area_heading">取扱ブランド</div>
          <div class="item-area_content">取扱ブランドはまだ登録されていません</div>
        </div>
        <div class="item-area">
          <div class="item-area_heading">取扱商品</div>
          <div class="item-area_content">取扱商品はまだ登録されていません</div>
        </div>
        <div class="item-area">
          <div class="item-area_heading">対応可能動物</div>
          <div class="item-area_content">対応可能動物はまだ登録されていません</div>
        </div>
      </div>
    <%# end %>
  </div>

  <!-- 口コミ -->
  <div class="shop-content_reviews">
    <%# if current_page?(user_path) %>
      <div class="reviews-header">
        <div class="reviews-header_count">全 3 件</div>
        <%= link_to "口コミを投稿する", root_path, class: 'reviews-header_post' %>
      </div>
      <!-- 口コミ投稿内容 -->
      <div class="reviews-box">
        <div class="reviews-box_reviews-info">
          <div class="reviews-box-user-info">
            <%= image_tag @petsitter.image.url, class:'reviews-box-user-info_photo' unless @petsitter.image.url.nil? %>
            <div class="reviews-box-user-info_name">
              テストさんの口コミ
            </div>
          </div>
        </div>
        <div class="reviews-box_reviews-rate">
          <div class="rate-container">
            ★★★★★ 3.5
          </div>
        </div>
        <div class="reviews-box_reviews-body">
          <div class="reviews-box_reviews-body_date">2021/01利用</div>
          <div class="reviews-box_reviews-body_title">素晴らしいペットシッター</div>
          <div class="reviews-box_reviews-body_text">とても親切に対応していただきました！ありがとうございます！</div>
        </div>
      </div>
    <%# end %>
  </div>

  <!-- 地図 -->
  <div class="shop-content_map">
    <%# if current_page?(user_path) %>
    <span class="petsitter-address"><%= @petsitter.address %></span>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=<%= ENV['GOOGLE_MAP_API_KEY'] %>&callback=initMap"></script>
    <%# end %>
  </div>
</div>


<% if current_page?(root_path) %>

<table class="table table-hover">
  <tbody>
  <tr>
    <%= image_tag @petsitter.image.url unless @petsitter.image.url.nil? %>
  </tr>
  
<!-- いいね機能 -->
  <%#= @petsitter.liked_users.count %>
  <%# if current_user.already_liked?(@petsitter) %>
    <%#= link_to petsitter_like_path(@petsitter.id), method: :delete, data: {"turbolinks" => false}, remote: true do %>
      <%#= fa_icon 'heart', id: "heart__red" %>
    <%# end %>
  <%# else %>
    <%#= link_to petsitter_likes_path(@petsitter.id), method: :post, data: {"turbolinks" => false}, remote: true do %>
      <%#= fa_icon 'heart', id: "heart__normal" %>
    <%# end %>
  <%# end %>

  <div class="like">
    <!-- いいね機能 -->
    <tr>いいね: <%= @petsitter.likes.count %>
      <% if current_user.already_liked?(@petsitter) %>
        <%= link_to petsitter_like_path(@petsitter.id), method: :delete do %>
          <%= fa_icon 'heart', id: "heart__red" %>
        <% end %>
      <% else %>
        <%= link_to petsitter_likes_path(@petsitter.id), method: :post do %>
          <%= fa_icon 'heart-o', id: "heart__normal" %>
        <% end %>
      <% end %>
      <p>いいねしたユーザー</p>
      <% @petsitter.liked_users.each do |user| %>
        <li><%= user.email %></li>
      <% end %>
    </tr>
  </div>

  <div class="temp_save">
    <!-- 一時保存機能 -->
    <tr>一時保存: <%= @petsitter.temp_save.count %>
      <% if current_user.already_temp_saved?(@petsitter) %>
        <%= link_to petsitter_temp_safe_path(@petsitter.id), method: :delete do %>
          <%= fa_icon 'heart', id: "heart__red" %>
        <% end %>
      <% else %>
        <%= link_to petsitter_temp_saves_path(@petsitter.id), method: :post do %>
          <%= fa_icon 'heart-o', id: "heart__normal" %>
        <% end %>
      <% end %>
    </tr>
  </div>






  <tr>
    <th><%= Petsitter.human_attribute_name(:id) %></th>
    <td><%= @petsitter.id %></td>
  </tr>

  <tr>
    <th><%= Petsitter.human_attribute_name(:name) %></th>
    <td><%= @petsitter.name %></td>
  </tr>

  <tr>
    <th><%= Petsitter.human_attribute_name(:email) %></th>
    <td><%= @petsitter.email %></td>
  </tr>

  <tr>
    <th><%= Petsitter.human_attribute_name(:address) %></th>
    <td><%= @petsitter.address %></td>
  </tr>

  <tr>
    <th><%= Petsitter.human_attribute_name(:phone) %></th>
    <td><%= @petsitter.phone %></td>
  </tr>

  <tr>
    <th><%= Petsitter.human_attribute_name(:business_hours) %></th>
    <td><%= @petsitter.business_hours %></td>
  </tr>

  <tr>
    <th><%= Petsitter.human_attribute_name(:regular_holiday) %></th>
    <td><%= @petsitter.regular_holiday %></td>
  </tr>

  <tr>
    <th><%= Petsitter.human_attribute_name(:pet_type) %></th>
    <td><%= @petsitter.pet_type %></td>
  </tr>

  <tr>
    <th><%= Petsitter.human_attribute_name(:qualification) %></th>
    <td><%= @petsitter.qualification %></td>
  </tr>

  <tr>
    <th><%= Petsitter.human_attribute_name(:registration_number) %></th>
    <td><%= @petsitter.registration_number %></td>
  </tr>

  <tr>
    <th><%= Petsitter.human_attribute_name(:insurance) %></th>
    <td>
      <%if @petsitter.insurance %>
        有
      <% else %>
        無
      <% end %>
    </td>
  </tr>

  <tr>
    <th><%= Petsitter.human_attribute_name(:created_at) %></th>
    <td><%= @petsitter.created_at %></td>
  </tr>

  <tr>
    <th><%= Petsitter.human_attribute_name(:updated_at) %></th>
    <td><%= @petsitter.updated_at %></td>
  </tr>

  <%= link_to "編集", edit_petsitter_path, class: 'btn btn-primary mr-3' %>
  <%= link_to "削除", @petsitter, method: :delete, data: {confirm: "ペットシッター#{@petsitter.name}を削除します。よろしいですか？"}, class: 'btn btn-danger', id:'Petsitter_delete_btn' %>

  </tbody>
</table>

<!-- 口コミ投稿フォーム -->
<%= render partial: 'reviews/form', locals: { review: @review } %>

<!-- 口コミ表示 -->
<%= render partial: 'reviews/show-reviews', locals: { reviews: @reviews } %>
<% end %>


<!-- googlemapテスト -->
<!--<h2>gmap</h2>-->

<div id='map'>
</div>

<style>
    #map{
        height: 400px;
        width: 600px;
    }
</style>

<script>

  let map
  let geocoder
  let marker
  let center
  let position

  function initMap(){

    // geocoderを初期化
    geocoder = new google.maps.Geocoder()

    // 入力を取得
    let address = gon.address;

    // geocoderを使って位置情報（緯度、軽度）を取得できるようにする
    geocoder.geocode( { 'address': address}, function(results, status) {
      // マップ中心とマップの場所指定を設定
      center = results[0].geometry.location;
      position = results[0].geometry.location;

      // マップ情報を設定
      map = new google.maps.Map(document.getElementById('map'), {
          center: center,
          position: position,
          zoom: 16,
      });

      // マーカーの場所情報を設定
      let markerOptions = {
          map: map,
          center: center,
          position: position,
      };

      // マーカー情報を確定
      let marker = new google.maps.Marker(markerOptions);

    });
  }

</script>
